
# persist history
export PROMPT_COMMAND="history -a"
export HISTSIZE=10000
export HISTFILESIZE=20000


# append to the history file, don't overwrite it
shopt -s histappend

# git-prompt setup
#Source: https://www.glukhov.org/post/2025/12/adding-git-repo-details-to-bash-prompt/

# Ensure git-prompt.sh is sourced (adjust path if necessary)
. /usr/share/bash-completion/completions/git
. /usr/lib/git-core/git-sh-prompt

# Configure Git prompt
export GIT_PS1_SHOWDIRTYSTATE=1
export GIT_PS1_SHOWUNTRACKEDFILES=1
export GIT_PS1_SHOWUPSTREAM="auto"
export GIT_PS1_SHOWCOLORHINTS=1
export GIT_PS1_DESCRIBE_STYLE="default"
export GIT_PS1_SHOWSTASHSTATE=1

# shell prompt

export PROMPT_DIRTRIM=2

#History line number, user, host, git-prompt info, relative PWD
#export PS1="\n\[\033[1;36m\][\!] \[\033[1;35m\]SB \[\033[0;35m\]\u@\h\[\033[00m\] \[\033[00m\]\$(__git_ps1 \"(%s)\") \[\033[1;34m\]\w\[\033[1;31m\] \[\033[00m\]\$ "    

#History line number, git-prompt info, relative PWD
#export PS1="\n\[\033[1;36m\][\!] \[\033[1;35m\]${SB_PROJECT_ID}|${SB_SANDBOX_ID}\033[00m\] \[\033[00m\]\$(__git_ps1 \"(%s)\") \[\033[1;34m\]\w\[\033[1;31m\] \[\033[00m\]\$ "    

#History line number, user, git-prompt info, relative PWD
export PS1="\n\[\033[0;36m\][\!] \[\033[0;35m\]${SB_PROJECT_ID}|${SB_SANDBOX_ID}\033[00m\] \[\033[0;33m\]\u \[\033[00m\]\$(__git_ps1 \"(%s) \")\[\033[1;34m\]\w\[\033[1;31m\] \[\033[00m\]\$ "    

# aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
alias l1='ls -1'
alias h=history
alias hr="fc -ln 1 | sed 's/^\s*//'" #show "raw" history (i.e without line numbers and leading whitespace)

#commented out- this causes failure in .bashrc ???
#gcloud SDK completion
# GCLOUD_BIN_PATH=$(which gcloud)
# GCLOUD_REAL_PATH=$(readlink -f $GCLOUD_BIN_PATH)
# GCLOUD_HOME="$(dirname $GCLOUD_REAL_PATH)/.."
# if [ -f "$GCLOUD_HOME/completion.bash.inc" ]; then
#     source $GCLOUD_HOME/completion.bash.inc
# end

#dotnet tools
export PATH=$HOME/.dotnet/tools:$PATH

# FZF keybindings
[ -f /usr/share/doc/fzf/examples/key-bindings.bash ] && source /usr/share/doc/fzf/examples/key-bindings.bash

# git config
git config --global core.autocrlf input  #ensure LF's stay in repo, 

export PATH=$HOME/.local/bin:$PATH

# execute shell login hooks provided by modules; each hook outputs a list of commands to execute
if [ -f /sandbox/hooks/shell-login/shell-login.sh ]; then
  source /sandbox/hooks/shell-login/shell-login.sh
fi

