# Devcontainer pnpm config

# Use hoisted node_modules (flat structure like npm/yarn)
# This avoids symlink/hardlink issues with Docker volumes
node-linker=hoisted

# Use copy instead of hardlink/clone for Docker volume compatibility
# Fixes ERR_PNPM_EACCES errors when atomic rename fails on Docker volumes
# See: https://pnpm.io/npmrc#package-import-method
package-import-method=copy

# Use persistent volume for pnpm cache (metadata + dlx)
# See: https://pnpm.io/npmrc#cache-dir
cache-dir=/workspace/main/.devcontainer-stores/packages/pnpm-cache

# Use persistent volume for pnpm store (for dlx package downloads)
store-dir=/workspace/main/.devcontainer-stores/packages/pnpm-store

# Use persistent volume for pnpm state (dlx tracking, update checks)
# See: https://pnpm.io/npmrc#state-dir
state-dir=/workspace/main/.devcontainer-stores/packages/pnpm-state

# Allow build scripts for global packages (claude-code, gemini-cli dependencies)
# See: https://pnpm.io/npmrc#onlybuiltdependencies
onlyBuiltDependencies[]=node-pty
onlyBuiltDependencies[]=protobufjs
onlyBuiltDependencies[]=tree-sitter-bash
